(this["webpackJsonpmesto-react-auth"]=this["webpackJsonpmesto-react-auth"]||[]).push([[0],{22:function(e,t,a){e.exports=a.p+"static/media/status-code-SUCCESS.7fc4c149.svg"},23:function(e,t,a){e.exports=a.p+"static/media/status-code-CLIENT_ERROR.c32299fa.svg"},24:function(e,t,a){e.exports=a.p+"static/media/status-code-LOADING-black.4f68ddc2.svg"},28:function(e,t,a){e.exports=a.p+"static/media/logo.9d0e3a93.svg"},30:function(e,t,a){e.exports=a.p+"static/media/edit.a41c84ef.svg"},31:function(e,t,a){e.exports=a.p+"static/media/plus.3742cf7e.svg"},32:function(e,t,a){e.exports=a.p+"static/media/trash.9c3b03ae.svg"},33:function(e,t,a){e.exports=a.p+"static/media/close.c2d0901f.svg"},37:function(e,t,a){e.exports=a(48)},42:function(e,t,a){},48:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(27),s=a.n(o),c=a(7),i=(a(42),a(35)),l=a(1),u=a(2),m=a(28),p=a.n(m);var _=function(e){return r.a.createElement("div",{className:"menu-mobile__position ".concat(e.isShowMenu)},r.a.createElement("menu",{className:"menu-mobile"},r.a.createElement("span",null,e.email),r.a.createElement("button",{className:"button link header__link menu-mobile__exit",onClick:e.signOut},"\u0412\u044b\u0439\u0442\u0438")))};var d=function(e){var t=Object(u.h)().pathname,a="".concat("/sign-in"===t?"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f":"\u0412\u043e\u0439\u0442\u0438"),n="".concat("/sign-in"===t?"/sign-up":"/sign-in");return r.a.createElement("header",{className:"header__position"},r.a.createElement("div",{className:"header"},r.a.createElement("img",{src:p.a,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \xabMesto Russia\xbb",className:"header__logo"}),e.loggedIn?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header__info-desktop"},r.a.createElement("span",null,e.email),r.a.createElement("button",{className:"button link header__link",onClick:e.signOut},"\u0412\u044b\u0439\u0442\u0438")),r.a.createElement("button",{className:"header__menu  ".concat(e.classHeaderMenu),onClick:function(){e.showMenu("mobile_position1")}},r.a.createElement("span",null))):r.a.createElement(c.b,{to:n,className:"button link header__link"},a)))},f=a(30),E=a.n(f),b=a(31),h=a.n(b),g=a(32),v=a.n(g),N=r.a.createContext(null);var O=function(e){var t=e.card,a=r.a.useContext(N),n=t.owner._id===a._id,o="button card__button-delete ".concat(n?"":"card__button-delete_invisible"),s=t.likes.some((function(e){return e._id===a._id})),c="button card__button-like ".concat(s?"card__button-like_solid":"");return r.a.createElement("li",{className:"card"},r.a.createElement("img",{src:t.link,alt:t.name,className:"card__image",onClick:function(){e.onCardZoom(t)}}),r.a.createElement("button",{className:o,type:"submit",onClick:function(){e.onCardDelete(t)}},r.a.createElement("img",{alt:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",className:"card__button-delete-vector",src:v.a})),r.a.createElement("div",{className:"card__description"},r.a.createElement("h2",{className:"card__name"},t.name),r.a.createElement("div",{className:"card__likes-container"},r.a.createElement("button",{className:c,type:"submit",onClick:function(){e.onCardLike(t)}}),r.a.createElement("p",{className:"card__count-likes"},t.likes.length))))};var y=function(e){var t=r.a.useContext(N);return r.a.createElement("main",{className:"content"},r.a.createElement("section",{className:"profile"},r.a.createElement("div",{className:"profile__position"},r.a.createElement("button",{className:"button profile__avatar-edit",type:"button",onClick:e.onEditAvatar,onKeyDown:e.onEditAvatar},r.a.createElement("img",{src:t.avatar,alt:t.name,className:"profile__avatar-image"})),r.a.createElement("div",{className:"profile__user-info"},r.a.createElement("div",{className:"profile__name-edit-position"},r.a.createElement("h1",{className:"profile__user-info-name"},t.name),r.a.createElement("button",{className:"button profile__button-edit",type:"button",onClick:e.onEditProfile,onKeyDown:e.onEditProfile},r.a.createElement("img",{alt:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",className:"profile__button-edit-vector",src:E.a}))),r.a.createElement("p",{className:"profile__user-info-about"},t.about))),r.a.createElement("button",{className:"button profile__button-add",type:"button",onClick:e.onAddCard,onKeyDown:e.onAddCard},r.a.createElement("img",{alt:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443",className:"profile__button-add-vector",src:h.a}))),r.a.createElement("ul",{className:"card-container"},e.cards.map((function(t){return r.a.createElement(O,{key:t._id,card:t,onCardLike:e.onCardLike,onCardZoom:e.onCardZoom,onCardDelete:e.onCardDelete})}))))};var C=function(){return r.a.createElement("footer",{className:"footer__position"},r.a.createElement("div",{className:"footer"},r.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia")))},S=a(33),k=a.n(S);var j=function(e){return r.a.createElement("img",{className:"button popup__close",onClick:e.closeHandler,src:k.a,alt:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"})};var I=function(e){return r.a.createElement("div",{className:"popup popup__closed popup__zoom-card ".concat(e.isOpen&&"popup_opened")},r.a.createElement("div",{className:"popup__zoom"},r.a.createElement("img",{src:e.image.link,alt:e.image.name,className:"popup__image"}),r.a.createElement(j,{closeHandler:e.onClose}),r.a.createElement("h2",{className:"popup__card-name"},e.image.name)),r.a.createElement("div",{className:"popup__overlay",onClick:e.onClose}))};var M=function(e){var t="".concat(e.entrance?"form__title":"form__title form__title_popup"),a="button form__button\n  ".concat(e.entrance?"form__button_type_entrance":"form__button_type_popup ".concat(e.isDisabled?"form__button_disabled":"")),n="".concat(e.entrance?"form__position":"form__position form__position_type_popup"),o="".concat(e.entrance?"form__container":"form__container form__container_popup");return r.a.createElement("div",{className:o},!e.entrance&&r.a.createElement(j,{closeHandler:e.onClose}),r.a.createElement("h2",{className:t},e.title),r.a.createElement("form",{className:n,name:e.name,noValidate:!0},e.entrance?r.a.createElement("div",{className:"form__position_type_entrance"},e.children," "):r.a.createElement(r.a.Fragment,null,e.children," "),!e.infoTooltip&&r.a.createElement("button",{type:"submit",className:a,onClick:e.onSubmit},e.submitName)),e.entrance&&r.a.createElement("span",{className:"form__entrance-text"},e.entranceText,r.a.createElement(c.b,{to:e.path,className:"link"},e.entranceLinkText)))};var w=function(e){return r.a.createElement("div",{className:"popup popup__closed popup__".concat(e.name," ").concat(e.isOpen?"popup_opened":"")},r.a.createElement(M,{title:e.title,name:e.name,isDisabled:e.isDisabled,onSubmit:e.onSubmit,submitName:e.submitName,children:e.children,isPopup:!0,infoTooltip:e.infoTooltip,onClose:e.onClose}),r.a.createElement("div",{className:"popup__overlay",onClick:e.onClose}))};var x=function(e){return r.a.createElement(w,{name:"are-you-sure",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",submitName:"\u0414\u0430",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onCardDelete()}})};var T=function(e){var t=r.a.useContext(N),a=r.a.useState(""),n=Object(l.a)(a,2),o=n[0],s=n[1],c=r.a.useState({classInput:"",classError:"",errorMessage:""}),i=Object(l.a)(c,2),u=i[0],m=i[1],p=r.a.useState(""),_=Object(l.a)(p,2),d=_[0],f=_[1],E=r.a.useState({classInput:"",classError:"",errorMessage:""}),b=Object(l.a)(E,2),h=b[0],g=b[1],v=r.a.useState(!0),O=Object(l.a)(v,2),y=O[0],C=O[1];return r.a.useEffect((function(){s(t.name),f(t.about),C(!0),m({classInput:"",classError:"",errorMessage:""}),g({classInput:"",classError:"",errorMessage:""})}),[t,e.isOpen]),r.a.createElement(w,{isOpen:e.isOpen,onClose:e.onClose,name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isDisabled:!y,submitName:e.isPopupLoading?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:o,about:d}),C(!0)}},r.a.createElement("label",{className:"form__field form__field_type_popup"},r.a.createElement("input",{className:"form__input form__input_type_popup ".concat(u.classInput),id:"name",maxLength:"40",name:"name",pattern:"[A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u0451]*[A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u0451]+[A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u0451\\s\\-]*[A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u0451]+[A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u0451\\s]*",placeholder:"\u0418\u043c\u044f",value:o,onChange:function(e){s(e.target.value),e.target.validity.valid?(m({classInput:"",classError:"",errorMessage:""}),C(!0)):(m({classInput:"form__input_error",classError:"form__error_visible",errorMessage:e.target.validationMessage}),C(!1))},type:"text",required:!0}),r.a.createElement("span",{className:"form__error ".concat(u.classError),id:"about-error"},u.errorMessage)),r.a.createElement("label",{className:"form__field form__field_type_popup"},r.a.createElement("input",{className:"form__input form__input_type_popup ".concat(h.classInput),id:"about",maxLength:"200",minLength:"2",name:"about",placeholder:"\u041e \u0441\u0435\u0431\u0435",value:d,onChange:function(e){f(e.target.value),e.target.validity.valid?(g({classInput:"",classError:"",errorMessage:""}),C(!0)):(g({classInput:"form__input_error",classError:"form__error_visible",errorMessage:e.target.validationMessage}),C(!1))},type:"text",required:!0}),r.a.createElement("span",{className:"form__error ".concat(h.classError),id:"about-error"},h.errorMessage)))};var L=function(e){var t=r.a.useRef(),a=r.a.useState({classInput:"",classError:"",errorMessage:""}),n=Object(l.a)(a,2),o=n[0],s=n[1],c=r.a.useState(!1),i=Object(l.a)(c,2),u=i[0],m=i[1];return r.a.useEffect((function(){s({classInput:"",classError:"",errorMessage:""}),m(!1),t.current.value=""}),[e.isOpen]),r.a.createElement(w,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(a){a.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})},isDisabled:!u,submitName:e.isPopupLoading?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},r.a.createElement("label",{className:"form__field form__field_type_popup"},r.a.createElement("input",{className:"form__input form__input_type_popup  ".concat(o.classInput),id:"link-avatar",ref:t,onChange:function(){var e=t.current;e.validity.valid?(s({classInput:"",classError:"",errorMessage:""}),m(!0)):(s({classInput:"form__input_error",classError:"form__error_visible",errorMessage:e.validationMessage}),m(!1))},name:"avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,type:"url"}),r.a.createElement("span",{className:"form__error ".concat(o.classError),id:"link-avatar-error"},o.errorMessage)))};var D=function(e){var t=r.a.useState(""),a=Object(l.a)(t,2),n=a[0],o=a[1],s=r.a.useState({classInput:"",classError:"",errorMessage:""}),c=Object(l.a)(s,2),i=c[0],u=c[1],m=r.a.useState(""),p=Object(l.a)(m,2),_=p[0],d=p[1],f=r.a.useState({classInput:"",classError:"",errorMessage:""}),E=Object(l.a)(f,2),b=E[0],h=E[1],g=r.a.useState(!1),v=Object(l.a)(g,2),N=v[0],O=v[1],y=r.a.useState(!1),C=Object(l.a)(y,2),S=C[0],k=C[1],j=r.a.useState(!1),I=Object(l.a)(j,2),M=I[0],x=I[1];return r.a.useEffect((function(){return N&&S&&x(!0),function(){x(!1)}}),[N,S]),r.a.useEffect((function(){u({classInput:"",classError:"",errorMessage:""}),h({classInput:"",classError:"",errorMessage:""}),o(""),d(""),O(!1),k(!1)}),[e.isOpen]),r.a.createElement(w,{name:"add-place",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddCardSubmit({name:n,link:_})},submitName:e.isPopupLoading?"\u0421\u043e\u0437\u0434\u0430\u0442\u044c...":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isDisabled:!M},r.a.createElement("label",{className:"form__field form__field_type_popup"},r.a.createElement("input",{className:"form__input form__input_type_popup ".concat(i.classInput),id:"name-card",maxLength:"30",minLength:"2",name:"title",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,type:"text",value:n,onChange:function(e){o(e.target.value),e.target.validity.valid?(u({classInput:"",classError:"",errorMessage:""}),O(!0)):(u({classInput:"form__input_error",classError:"form__error_visible",errorMessage:e.target.validationMessage}),O(!1))}}),r.a.createElement("span",{className:"form__error ".concat(i.classError),id:"about-error"},i.errorMessage)),r.a.createElement("label",{className:"form__field form__field_type_popup"},r.a.createElement("input",{className:"form__input form__input_type_popup ".concat(b.classInput),id:"link",name:"src",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,type:"url",value:_,onChange:function(e){d(e.target.value),e.target.validity.valid?(h({classInput:"",classError:"",errorMessage:""}),k(!0)):(h({classInput:"form__input_error",classError:"form__error_visible",errorMessage:e.target.validationMessage}),k(!1))}}),r.a.createElement("span",{className:"form__error ".concat(b.classError),id:"about-error"},b.errorMessage)))};var z=function(){return r.a.createElement("div",{className:"spinner__position"},r.a.createElement("div",{className:"spinner"}))},A=a(9),U=a(34),P="https://auth.nomoreparties.co",Z=new(function(){function e(t){Object(A.a)(this,e),this._baseUrl=t.baseUrl,this._authorization=t.authorization}return Object(U.a)(e,[{key:"_fetch",value:function(e,t){return fetch(this._baseUrl+e,t).then((function(e){return e.ok?e.json():Promise.reject(new Error("\u041d\u0443 \u0432\u043e\u0442, \u0432\u0441\u0435 \u043f\u0440\u043e\u043f\u0430\u043b\u043e (\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status,")")))}))}},{key:"getInitialUserInfo",value:function(){return this._fetch("/users/me",{method:"GET",headers:{authorization:this._authorization}})}},{key:"editUserInfo",value:function(e){var t=e.name,a=e.about;return this._fetch("/users/me",{method:"PATCH",headers:{authorization:this._authorization,"Content-Type":"application/json"},body:JSON.stringify({name:t,about:a})})}},{key:"editUserAvatar",value:function(e){var t=e.avatar;return this._fetch("/users/me/avatar",{method:"PATCH",headers:{authorization:this._authorization,"Content-Type":"application/json"},body:JSON.stringify({avatar:t})})}},{key:"getInitialCards",value:function(){return this._fetch("/cards",{method:"GET",headers:{authorization:this._authorization}})}},{key:"postUserCard",value:function(e){var t=e.name,a=e.link;return this._fetch("/cards",{method:"POST",headers:{authorization:this._authorization,"Content-Type":"application/json"},body:JSON.stringify({name:t,link:a})})}},{key:"deleteCard",value:function(e){return this._fetch("/cards/".concat(e),{method:"DELETE",headers:{authorization:this._authorization}})}},{key:"changeLikeCardStatus",value:function(e,t){return this._fetch("/cards/likes/".concat(e),{method:t?"PUT":"DELETE",headers:{authorization:this._authorization}})}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-12",authorization:"2ecad59e-1d15-4621-aac6-769c45c3d932"});var R=function(e){var t=r.a.useState(""),a=Object(l.a)(t,2),n=a[0],o=a[1],s=r.a.useState({classInput:"",classError:"",errorMessage:""}),c=Object(l.a)(s,2),i=c[0],u=c[1],m=r.a.useState({classInput:"",classError:"",errorMessage:""}),p=Object(l.a)(m,2),_=p[0],d=p[1],f=r.a.useState(""),E=Object(l.a)(f,2),b=E[0],h=E[1],g=r.a.useState(!1),v=Object(l.a)(g,2),N=v[0],O=v[1],y=r.a.useState(!1),C=Object(l.a)(y,2),S=C[0],k=C[1],j=r.a.useState(!1),I=Object(l.a)(j,2),w=I[0],x=I[1],T=r.a.useState("password"),L=Object(l.a)(T,2),D=L[0],z=L[1];return r.a.useEffect((function(){return N&&S&&x(!0),function(){x(!1)}}),[N,S]),r.a.createElement("div",{className:"entrance"},r.a.createElement(M,{formName:"entrance",title:e.title,submitName:e.submitName,entrance:!0,onSubmit:function(t){t.preventDefault(),(n||b)&&(e.onSubmit(b,n),h(""))},path:e.path,entranceText:e.entranceText,entranceLinkText:e.entranceLinkText,isDisabled:!w},r.a.createElement("label",{className:"form__field form__field_type_entrance"},r.a.createElement("input",{name:"email",className:"form__input form__input_type_entrance ".concat(i.classInput),id:"name-card",placeholder:"Email",required:!0,type:"email",value:n,onChange:function(e){o(e.target.value),e.target.validity.valid?(u({classInput:"",classError:"",errorMessage:""}),O(!0)):(u({classInput:"form__input_error",classError:"form__error_visible",errorMessage:e.target.validationMessage}),O(!1))}}),r.a.createElement("span",{className:"form__error ".concat(i.classError),id:"about-error"},i.errorMessage)),r.a.createElement("label",{className:"form__field form__field_type_entrance"},r.a.createElement("input",{className:"form__input form__input_type_entrance ".concat(_.classInput),onChange:function(e){h(e.target.value),e.target.validity.valid?(d({classInput:"",classError:"",errorMessage:""}),k(!0)):(d({classInput:"form__input_error",classError:"form__error_visible",errorMessage:e.target.validationMessage}),k(!1))},type:D,id:"password",name:"password",value:b,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",minLength:"4",maxLength:"30",required:!0}),r.a.createElement("button",{type:"button",className:"button form__input-password form__input-password_type_".concat(D," "),onClick:function(){z("password"===D?"text":"password")},onKeyDown:function(e){return e.preventDefault}}),r.a.createElement("span",{className:"form__error ".concat(_.classError),id:"about-error"},_.errorMessage))))};var q=function(e){return r.a.createElement(R,{submitName:"\u0412\u043e\u0439\u0442\u0438",title:"\u0412\u0445\u043e\u0434",entranceText:"\u0415\u0449\u0451 \u043d\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? ",entranceLinkText:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",path:"/sign-up",onSubmit:function(t,a){e.onLogin(t,a)},cleanCodeStatusInfo:e.cleanCodeStatusInfo})};var H=function(e){return r.a.createElement(R,{submitName:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",entranceText:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? ",entranceLinkText:"\u0412\u043e\u0439\u0442\u0438",onSubmit:function(t,a){e.onRegister(t,a)},path:"/sign-in"})},J=a(36),G=function(e){var t=e.component,a=Object(J.a)(e,["component"]);return r.a.createElement(u.b,null,(function(){return a.loggedIn?r.a.createElement(t,a):r.a.createElement(u.a,{to:"/sign-in"})}))};var K=function(e){return r.a.createElement(w,{name:"info-tooltip",formName:"infoTooltip",isOpen:e.isOpen,onClose:e.onClose,loggedIn:e.loggedIn,infoTooltip:!0},r.a.createElement("img",{src:e.codeStatusInfo.iconStatus,alt:"\u0418\u043a\u043e\u043d\u043a\u0430 \u0441 \u043e\u0442\u0432\u0435\u0442\u043e\u043c \u0441\u0435\u0440\u0432\u0435\u0440\u0430",className:"form__icon"}),r.a.createElement("div",{className:"form__position-title-popup-info"},r.a.createElement("p",{className:"form__title"},e.codeStatusInfo.text)))},B=a(15),F=a(17),W=a(18),V=function(e){Object(B.a)(a,e);var t=Object(F.a)(a);function a(e){var n;return Object(A.a)(this,a),(n=t.call(this,e)).status=400,n.message=e,n}return a}(Object(W.a)(Error)),$=function(e){Object(B.a)(a,e);var t=Object(F.a)(a);function a(e){var n;return Object(A.a)(this,a),(n=t.call(this,e)).status=401,n.message=e,n}return a}(Object(W.a)(Error)),Q=function(e){return fetch("".concat(P,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.ok?e.json():e.json().then((function(e){throw new $(e.message)}))})).then((function(e){return e}))},X=a(22),Y=a.n(X),ee=a(23),te=a.n(ee),ae=a(24),ne=a.n(ae);var re=function(){var e=r.a.useState({name:"",avatar:"",about:"",_id:""}),t=Object(l.a)(e,2),a=t[0],n=t[1],o=r.a.useState([]),s=Object(l.a)(o,2),c=s[0],m=s[1],p=r.a.useState(!1),f=Object(l.a)(p,2),E=f[0],b=f[1],h=r.a.useState(!1),g=Object(l.a)(h,2),v=g[0],O=g[1],S=r.a.useState(!1),k=Object(l.a)(S,2),j=k[0],M=k[1],w=r.a.useState(!1),A=Object(l.a)(w,2),U=A[0],R=A[1],J=r.a.useState(!1),B=Object(l.a)(J,2),F=B[0],W=B[1],X=r.a.useState(!1),ee=Object(l.a)(X,2),ae=ee[0],re=ee[1],oe=r.a.useState({link:"",name:""}),se=Object(l.a)(oe,2),ce=se[0],ie=se[1],le=r.a.useState(!1),ue=Object(l.a)(le,2),me=ue[0],pe=ue[1],_e=r.a.useState({}),de=Object(l.a)(_e,2),fe=de[0],Ee=de[1],be=r.a.useState(!1),he=Object(l.a)(be,2),ge=he[0],ve=he[1],Ne=r.a.useState(""),Oe=Object(l.a)(Ne,2),ye=Oe[0],Ce=Oe[1],Se=r.a.useState(!1),ke=Object(l.a)(Se,2),je=ke[0],Ie=ke[1],Me=r.a.useState({iconStatus:ne.a,text:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."}),we=Object(l.a)(Me,2),xe=we[0],Te=we[1],Le=r.a.useState("menu-mobile_type_close"),De=Object(l.a)(Le,2),ze=De[0],Ae=De[1],Ue=r.a.useState("header__menu_type_closed"),Pe=Object(l.a)(Ue,2),Ze=Pe[0],Re=Pe[1],qe=Object(u.h)(),He=Object(u.g)();function Je(){Te({iconStatus:ne.a,text:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."})}function Ge(){b(!1),O(!1),M(!1),R(!1),pe(!1),Ie(!1)}function Ke(e){"Escape"===e.key&&Ge()}function Be(){ve(!1),localStorage.removeItem("jwt"),Ce(""),He.push("/sign-in")}return r.a.useEffect((function(){var e=localStorage.getItem("jwt");e&&Q(e).then((function(e){ve(!0),Ce(e.data.email),He.push("/")})).catch((function(e){return console.log(e)}))}),[He]),r.a.useEffect((function(){W(!0),Promise.all([Z.getInitialUserInfo(),Z.getInitialCards()]).then((function(e){var t=Object(l.a)(e,2),a=t[0],r=t[1];n(a),m(r),W(!1)})).catch((function(e){return console.log("\u0414\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438 \u043d\u0435 \u043f\u0440\u043e\u0433\u0440\u0443\u0437\u0438\u043b\u0438\u0441\u044c. ".concat(e))}))}),[]),r.a.useEffect((function(){return window.addEventListener("keydown",Ke),function(){window.removeEventListener("keydown",Ke)}})),r.a.createElement(N.Provider,{value:a},ge&&r.a.createElement(_,{email:ye,signOut:Be,isShowMenu:ze}),r.a.createElement(d,{loggedIn:ge,locaction:qe,email:ye,signOut:Be,showMenu:function(){Ae("menu-mobile_type_close"===ze?"menu-mobile_type_open":"menu-mobile_type_close"),Re("header__menu_type_opened"===Ze?"header__menu_type_closed":"header__menu_type_opened")},classHeaderMenu:Ze}),r.a.createElement(u.d,null,F?r.a.createElement(z,null):r.a.createElement(G,{exact:!0,path:"/",loggedIn:ge,component:y,onEditAvatar:function(){b(!0)},onEditProfile:function(){O(!0)},onAddCard:function(){M(!0)},onCardZoom:function(e){pe(!0),ie({link:e.link,name:e.name})},onCardDelete:function(e){Ee(e),R(!0)},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===a._id}));Z.changeLikeCardStatus(e._id,!t).then((function(t){var a=c.map((function(a){return a._id===e._id?t:a}));m(a)})).catch((function(e){console.log("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043b\u0430\u0439\u043a. ".concat(e))}))},cards:c}),r.a.createElement(u.b,{path:"/sign-in"},r.a.createElement(q,{onLogin:function(e,t){Je(),function(e,t){return fetch("".concat(P,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then((function(e){if(400===e.status)throw new V("\u041d\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043e \u043e\u0434\u043d\u043e \u0438\u0437 \u043f\u043e\u043b\u0435\u0439");if(401===e.status)throw new $("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441 \u0442\u0430\u043a\u0438\u043c email \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d");return e.json()})).then((function(e){if(e.token)return localStorage.setItem("jwt",e.token),e.token}))}(escape(e),t).then((function(e){Q(e).then((function(e){Ce(e.data.email)})).catch((function(e){return console.log(e)})),ve(!0),Te({iconStatus:Y.a,text:"\u0412\u0445\u043e\u0434 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d!"}),He.push("/")})).catch((function(e){return Te({iconStatus:te.a,text:e.message})})),Ie(!0)}})),r.a.createElement(u.b,{path:"/sign-up"},r.a.createElement(H,{onRegister:function(e,t){Je(),function(e,t){return fetch("".concat(P,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then((function(e){return e.ok?e.json():e.json().then((function(e){throw e.error?new V(e.error):new V(e.message)}))}))}(escape(e),t).then((function(){Te({iconStatus:Y.a,text:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0448\u043b\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e!"})})).catch((function(e){return Te({iconStatus:te.a,text:e.message})})),Ie(!0)}})),r.a.createElement(u.b,null,ge?r.a.createElement(u.a,{to:"/"}):r.a.createElement(u.a,{to:"/sign-in"}))),r.a.createElement(C,null),r.a.createElement(L,{isOpen:E,isPopupLoading:ae,onClose:Ge,onUpdateAvatar:function(e){var t=e.avatar;return re(!0),Z.editUserAvatar({avatar:t}).then((function(e){n(e),Ge()})).catch((function(e){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0430\u0432\u0430\u0442\u0430\u0440\u0430. ".concat(e))})).finally((function(){re(!1)}))}}),r.a.createElement(T,{isOpen:v,isPopupLoading:ae,onClose:Ge,onUpdateUser:function(e){var t=e.name,a=e.about;return re(!0),Z.editUserInfo({name:t,about:a}).then((function(e){n(e),Ge()})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435. ".concat(e))})).finally((function(){re(!1)}))}}),r.a.createElement(D,{isOpen:j,isPopupLoading:ae,onClose:Ge,onAddCardSubmit:function(e){var t=e.name,a=e.link;return re(!0),Z.postUserCard({name:t,link:a}).then((function(e){m([e].concat(Object(i.a)(c))),Ge()})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438. ".concat(e))})).finally((function(){re(!1)}))}}),r.a.createElement(x,{isOpen:U,onClose:Ge,onCardDelete:function(){Z.deleteCard(fe._id).then((function(){var e=c.filter((function(e){return e._id!==fe._id}));m(e),Ge()})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438. ".concat(e))}))}}),r.a.createElement(K,{isOpen:je,onClose:Ge,loggedIn:ge,codeStatusInfo:xe}),r.a.createElement(I,{isOpen:me,onClose:Ge,image:ce}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(c.a,null,r.a.createElement(re,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[37,1,2]]]);
//# sourceMappingURL=main.7b4f48f2.chunk.js.map